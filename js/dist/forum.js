module.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=27)}([function(t,e){t.exports=flarum.core.compat.app},function(t,e){t.exports=flarum.core.compat.extend},function(t,e,n){"use strict";function r(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}n.d(e,"a",(function(){return r}))},function(t,e){t.exports=flarum.core.compat.Model},function(t,e){t.exports=flarum.core.compat["components/Badge"]},,function(t,e){t.exports=flarum.core.compat.Component},function(t,e){t.exports=flarum.core.compat["models/Discussion"]},function(t,e){t.exports=flarum.core.compat["utils/extractText"]},,function(t,e){t.exports=flarum.core.compat["components/DiscussionPage"]},function(t,e){t.exports=flarum.core.compat["utils/mixin"]},function(t,e){t.exports=flarum.core.compat["components/DiscussionHero"]},function(t,e){t.exports=flarum.core.compat["helpers/username"]},function(t,e){t.exports=flarum.core.compat["helpers/avatar"]},function(t,e){t.exports=flarum.core.compat["helpers/userOnline"]},function(t,e){t.exports=flarum.core.compat["helpers/listItems"]},function(t,e){t.exports=flarum.core.compat["helpers/icon"]},function(t,e){t.exports=flarum.core.compat["utils/humanTime"]},function(t,e){t.exports=flarum.core.compat["components/Button"]},function(t,e){t.exports=flarum.core.compat["components/DiscussionList"]},function(t,e){t.exports=flarum.core.compat["components/DiscussionListItem"]},function(t,e){t.exports=flarum.core.compat["components/PostStream"]},function(t,e){t.exports=flarum.core.compat["utils/DiscussionControls"]},,,,function(t,e,n){"use strict";n.r(e);var r=n(1),o=n(0),a=n.n(o),s=n(10),i=n.n(s),u=n(7),c=n.n(u),l=n(4),p=n.n(l),d=n(3),f=n.n(d),h=n(2),b=n(11),w=function(t){function e(){return t.apply(this,arguments)||this}return Object(h.a)(e,t),e}(n.n(b)()(f.a,{last_read_at:f.a.attribute("last_read_at"),last_read_post_number:f.a.attribute("last_read_post_number"),subscription:f.a.attribute("subscription"),unread:f.a.attribute("unread"),user:f.a.hasOne("user")})),_=n(12),x=n.n(_),g=n(6),k=n.n(g),y=n(13),v=n.n(y),R=n(14),O=n.n(R),j=n(15),W=n.n(j),D=n(16),P=n.n(D),C=n(17),N=n.n(C),I=n(8),M=n.n(I),S=n(18),B=n.n(S),U=n(19),A=n.n(U),L=function(t){function e(){return t.apply(this,arguments)||this}return Object(h.a)(e,t),e.prototype.view=function(){var t=this.props,e=t.discussion,n=t.className,r=!!e.attribute("whoReadUnread");return A.a.component({className:n,icon:"fas fa-eye-slash",children:a.a.translator.trans("clarkwinkelmann-who-read.forum.controls."+(r?"remove":"set")+"-unread"),onclick:function(){e.save({whoReadUnread:!r}).then((function(){m.redraw()}))}})},e}(k.a),T=function(t){function e(){return t.apply(this,arguments)||this}return Object(h.a)(e,t),e.prototype.view=function(){var t=this,e=a.a.forum.attribute("who-read.maxVisible"),n=[],r=this.props.readers.filter((function(e){if(null===e.last_read_post_number())return!1;if(!t.props.discussion)return!0;var n=a.a.forum.attribute("who-read.hideWhenBehind");return!n||e.last_read_post_number()>t.props.discussion.lastPostNumber()-n}));return r.forEach((function(o,s){if(!t.showAll){if(s===e){var i=r.length-e;n.push(m("span.Avatar.WhoRead-more",{title:M()(a.a.translator.trans("clarkwinkelmann-who-read.forum.show-more",{count:i})),onclick:function(e){e.preventDefault(),t.showAll=!0}},"+"+i))}if(s>=e)return}var u=o.user();if(u){var c=u.badges();if(flarum.extensions["flarum-subscriptions"])switch(o.subscription()){case"follow":c.add("subscriptions-follow",p.a.component({label:a.a.translator.trans("flarum-subscriptions.forum.badge.following_tooltip"),icon:"fas fa-star",type:"following"}));break;case"ignore":c.add("subscriptions-ignoring",p.a.component({label:a.a.translator.trans("flarum-subscriptions.forum.badge.ignoring_tooltip"),icon:"far fa-eye-slash",type:"ignoring"}))}o.unread()&&c.add("who-read-unread",p.a.component({type:"who-read-unread",icon:"fas fa-eye-slash",label:a.a.translator.trans("clarkwinkelmann-who-read.forum.badges.unread")}));var l=o.unread()||t.props.discussion&&o.last_read_post_number()<t.props.discussion.lastPostNumber(),d="last_read_at";t.props.discussion&&(d=l?"last_read_at_behind":"last_read_at_up_to_date"),n.push(m("a",{href:a.a.route.user(u),title:M()(a.a.translator.trans("clarkwinkelmann-who-read.forum.tooltip."+d,{user:u,ago:B()(o.last_read_at())})),config:function(t){$(t).tooltip({placement:"top"}),m.route.apply(this,arguments)}},[m(".WhoRead-avatar",{className:l?"WhoRead-avatar--outdated":""},[O()(u),t.props.extended?m("ul.badges",P()(c.toArray())):null]),t.props.extended?m(".WhoRead-user",[W()(u),v()(u)]):null]))}})),m(".WhoRead",{className:this.props.extended?"WhoRead--extended":""},[this.props.toggleable?m(".WhoRead-toggle",{onclick:function(){t.visible=!t.visible}},N()("fas fa-chevron-"+(this.visible?"up":"down"))):null,this.props.title?m("h3",{onclick:function(){t.visible=!t.visible}},this.props.title):null,!this.props.toggleable||this.visible?m("ul.WhoRead-list",n.map((function(t){return m("li.WhoRead-item",t)}))):null,this.props.unreadControlDiscussion&&this.props.unreadControlDiscussion.attribute("whoReadCanMarkUnread")?L.component({className:"Button",discussion:this.props.unreadControlDiscussion}):null])},e}(k.a),E=n(20),H=n.n(E),q=n(21),z=n.n(q),V=n(22),F=n.n(V),G=n(23),J=n.n(G);a.a.initializers.add("clarkwinkelmann-who-read",(function(){a.a.store.models["clarkwinkelmann-who-readers"]=w,c.a.prototype.clarkwinkelmannWhoReaders=c.a.hasMany("clarkwinkelmannWhoReaders"),Object(r.extend)(c.a.prototype,"badges",(function(t){this.attribute("whoReadUnread")&&t.add("who-read-unread",p.a.component({type:"who-read-unread",icon:"fas fa-eye-slash",label:a.a.translator.trans("clarkwinkelmann-who-read.forum.badges.unread")}))})),Object(r.extend)(f.a.prototype,"save",(function(t,e){e.lastReadPostNumber&&t.then((function(){m.redraw()}))})),Object(r.extend)(i.a.prototype,"params",(function(t){a.a.forum.attribute("who-read.canSee")&&t.include.push("clarkwinkelmannWhoReaders.user.groups")})),Object(r.extend)(x.a.prototype,"items",(function(t){if(a.a.forum.attribute("who-read.showInHero")){var e=this.props.discussion.clarkwinkelmannWhoReaders();e&&e.length&&t.add("who-read",T.component({readers:e,discussion:this.props.discussion,extended:!0}),-10)}})),Object(r.extend)(H.a.prototype,"requestParams",(function(t){a.a.forum.attribute("who-read.showInDiscussionList")&&t.include.push("clarkwinkelmannWhoReaders.user.groups")})),Object(r.extend)(z.a.prototype,"infoItems",(function(t){if(a.a.forum.attribute("who-read.showInDiscussionList")){var e=this.props.discussion.clarkwinkelmannWhoReaders();e&&e.length&&t.add("who-read",T.component({readers:e,discussion:this.props.discussion}),-120)}})),Object(r.extend)(F.a.prototype,"view",(function(t){var e=this,n=this.discussion.clarkwinkelmannWhoReaders();n&&t.children.forEach((function(t){if(a.a.forum.attribute("who-read.showBetweenPosts")&&t.attrs&&t.attrs["data-id"]){var r=a.a.store.getById("posts",t.attrs["data-id"]),o=[];if(n=n.filter((function(t){var e=t.last_read_post_number()>=r.number();return e||o.push(t),e})),e.discussion.postIds()[e.visibleStart]===t.attrs["data-id"])return;o.length&&t.children.unshift(T.component({readers:o,extended:!0,title:a.a.translator.trans("clarkwinkelmann-who-read.forum.stats.to_at_least_here",{count:o.length+n.length}),toggleable:!0}))}if(t.attrs&&"reply"===t.attrs.key){var s=e.discussion.clarkwinkelmannWhoReaders().filter((function(t){return t.last_read_post_number()>=e.discussion.lastPostNumber()}));s.length>0&&t.children.unshift(T.component({readers:s,extended:!0,title:a.a.translator.trans("clarkwinkelmann-who-read.forum.stats.to_end",{count:s.length}),unreadControlDiscussion:e.discussion}))}}))})),Object(r.extend)(J.a,"userControls",(function(t,e){e.attribute("whoReadCanMarkUnread")&&t.add("who-read-unread",L.component({discussion:e}))}))}))}]);
//# sourceMappingURL=forum.js.map